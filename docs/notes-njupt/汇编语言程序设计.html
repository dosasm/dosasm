<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DosAsm Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DosAsm Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">4 汇编语言程序 | DosAsm</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://dosasm.gitee.io/docs/notes-njupt/汇编语言程序设计"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="4 汇编语言程序 | DosAsm"><meta data-react-helmet="true" name="description" content="汇编语言程序结构"><meta data-react-helmet="true" property="og:description" content="汇编语言程序结构"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://dosasm.gitee.io/docs/notes-njupt/汇编语言程序设计"><link data-react-helmet="true" rel="alternate" href="https://dosasm.gitee.io/docs/notes-njupt/汇编语言程序设计" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://dosasm.gitee.io/docs/notes-njupt/汇编语言程序设计" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.823a8fb9.css">
<link rel="preload" href="/assets/js/runtime~main.e84f90be.js" as="script">
<link rel="preload" href="/assets/js/main.ffb5ba16.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/my-img/dosboxasm.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/my-img/dosboxasm.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">DosAsm</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">教程</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/references/README">参考</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/notes-njupt/总览">微机笔记</a><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a href="https://dosasm.gitee.io/dosrun" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>PlayGround<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/dosasm/dosasm" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/intro">DosAsm</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">VSCode插件</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">React应用</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/awesome-assembly">汇编代码样例</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">参考信息</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">参考-微机原理与接口技术</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/总览">目录</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/微型计算机基础">1 微型计算机基础</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/02_80x86微处理器">2 80x86微处理器</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/汇编语言指令集">3 汇编语言指令集</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/notes-njupt/汇编语言程序设计">4 汇编语言程序</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/输入输出系统">7 输入/输出系统</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/中断系统">8 中断系统</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/串口通信">9 串口通信</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/并行IO接口">10 并行I/O 接口</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/可编程定时计数器">11 可编程定时器/计数器</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/ky">考研初试复习</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes-njupt/题目">题目</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>4 汇编语言程序</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="汇编语言程序结构"></a>汇编语言程序结构<a class="hash-link" href="#汇编语言程序结构" title="Direct link to heading">#</a></h2><p>一个完整的源程序<sup id="fnref-简化"><a href="#fn-简化" class="footnote-ref">简化</a></sup>在结构上必须做到：</p><ul><li>用方式选择伪指令说明执行该程序的微处理器类型</li><li>用段定义语句定义每一个逻辑段</li><li>用<code>ASSUME</code>语句说明段约定</li><li>用汇编结束语句说明程序结束</li></ul><p>完整的段定义格式</p><ol><li>方式选择伪指令<sup id="fnref-方式选择伪指令"><a href="#fn-方式选择伪指令" class="footnote-ref">方式选择伪指令</a></sup></li><li>段定义语句<code>定位参数,链接参数,‘分类名’ （仅作了解）</code></li><li>段约定语句</li><li>汇编结束语句</li><li>返回DOS语句</li></ol><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W assembly"><pre tabindex="0" class="prism-code language-assembly codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">.586                      ;方式定义</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">;定义数据段</span></span><span class="token-line" style="color:#393A34"><span class="token plain">DATA    SEGMENT USE16</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ;... ...此处定义数据</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MSG DB &#x27;hello world$&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ;... ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">DATA    ENDS</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">;定义代码段</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE SEGMENT USE16</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ASSUME CS:CODE,DS:DATA  ;说明段约定</span></span><span class="token-line" style="color:#393A34"><span class="token plain">BEG:                        ;BEG为启动地址</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MOV AX,DATA          </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MOV DS,AX</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ;... ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MOV    AH,9</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MOV    DX, OFFSET MSG</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    INT    21H</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MOV    AH,4CH</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    INT    21H</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ;... ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MOV AH,4CH</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    INT 21H                ;返回DOS</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE ENDS</span></span><span class="token-line" style="color:#393A34"><span class="token plain">END BEG                    ;汇编结束</span></span></code></pre><a type="button" aria-label="Run in new tab" href="https://dosasm.gitee.io/dosrun/?env=MASM_6.11&amp;exec=run&amp;code=.586++++++++++++++++++++++%3B%E6%96%B9%E5%BC%8F%E5%AE%9A%E4%B9%89%0A%0A%3B%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E6%AE%B5%0ADATA++++SEGMENT+USE16%0A++++%3B...+...%E6%AD%A4%E5%A4%84%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%0A++++MSG+DB+%27hello+world%24%27%0A++++%3B...+...%0ADATA++++ENDS%0A%0A%3B%E5%AE%9A%E4%B9%89%E4%BB%A3%E7%A0%81%E6%AE%B5%0ACODE+SEGMENT+USE16%0A++++ASSUME+CS%3ACODE%2CDS%3ADATA++%3B%E8%AF%B4%E6%98%8E%E6%AE%B5%E7%BA%A6%E5%AE%9A%0ABEG%3A++++++++++++++++++++++++%3BBEG%E4%B8%BA%E5%90%AF%E5%8A%A8%E5%9C%B0%E5%9D%80%0A++++MOV+AX%2CDATA++++++++++%0A++++MOV+DS%2CAX%0A++++%3B...+...%0A++++MOV++++AH%2C9%0A++++MOV++++DX%2C+OFFSET+MSG%0A++++INT++++21H%0A++++MOV++++AH%2C4CH%0A++++INT++++21H%0A++++%3B...+...%0A++++MOV+AH%2C4CH%0A++++INT+21H++++++++++++++++%3B%E8%BF%94%E5%9B%9EDOS%0ACODE+ENDS%0AEND+BEG++++++++++++++++++++%3B%E6%B1%87%E7%BC%96%E7%BB%93%E6%9D%9F" target="_blank" class="runButton_2gRE clean-btn">Run</a><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="汇编源程序的编程格式"></a>汇编源程序的编程格式<a class="hash-link" href="#汇编源程序的编程格式" title="Direct link to heading">#</a></h3><p>汇编源程序有两种编程格式:
EXE文件的编程格式：只能生成扩展为EXE 的可执行文件；
COM文件的编程格式：可以生成扩展为COM的可执行文件。
COM文件的执行级别高于EXE文件,同名的BAT(批处理)文件执行级别最低。</p><ul><li>E许源程序使用多个逻辑段（包括据段、堆栈段、代码段及其它逻辑段）；在实模式下,每个逻辑段的目标块不超过64K；适合编写大型程序。</li><li>COM文件的编程格式适合于编写中小型程序。汇编语言要求COM须符合以下规定:<ul><li>源程序只允许使用一个逻辑段,即代码段,不允许设置堆栈段;</li><li>需使用定位ORG伪指令将程序的启动指令存放在代码段偏移地址为100H的单元。</li><li>程序使用的数据,可以集中设置在代码段的开始或未尾;</li><li>代码段目标块小于64K。</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="dos调用"></a>DOS调用<a class="hash-link" href="#dos调用" title="Direct link to heading">#</a></h2><p>DOS的4个组成部分中IBMBIO.COM是DOS系统的核心模块,为基本I/O设备处理程序,与BIOS一起完成数据输入和数据输出的基本操作DOS和BIOS均有若干子功能可以被用户程序调用，称为“DOS调用”和“BIOS调用”</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W assembly"><pre tabindex="0" class="prism-code language-assembly codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">MOV AH,[功能号];设置入口参数</span></span><span class="token-line" style="color:#393A34"><span class="token plain">INT n;分析出口参数</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn">Copy</button></div></div><ul><li>其中n值因子程序不同而可能不同，比如：ROM BIOS有n=5~1FH,DOS有n=20H, 21H, 23~2AH,2EH,2FH,33H和67H等几种情况。有的n只对应一个子程序，有的n对应很多子程序。</li><li>调用结束后一般都有出口参数，这些出口参数常放在寄存器中，通过出口参数可以知道功能调用的成功与否。</li><li>在DOS功能子程序调用中，我们把通过INT21H来实现的子程序调用称为DOS系统功能调用。</li></ul><table><thead><tr><th>功能号</th><th>功能</th><th>入口参数</th><th>出口参数</th></tr></thead><tbody><tr><td><strong>01H</strong></td><td>等待键入一个字符，有回显，响应Ctrl_C</td><td>无</td><td>AL=按键的ASCII码。<sup id="fnref-01h"><a href="#fn-01h" class="footnote-ref">01H</a></sup></td></tr><tr><td><strong>02H</strong></td><td>显示一个字符，响应Ctrl_C<sup id="fnref-02h"><a href="#fn-02h" class="footnote-ref">02H</a></sup></td><td>DL=待显字符的ASCII码</td><td>无</td></tr><tr><td><strong>07H</strong></td><td>等待键入一个字符，无回显，<strong>不响应Ctrl_C</strong></td><td>无</td><td>AL＝按键的ASCII码,若AL＝0,需再次调用该项功能才能在AL中得到按键的扩展码。</td></tr><tr><td><strong>08H</strong></td><td>等待键入一个字符，无回显，<strong>响应Ctrl_C</strong></td><td>无</td><td>AL＝按键的ASCII码,若AL＝0,需再次调用该项功能才能在AL中得到按键的扩展码。</td></tr><tr><td><strong>09H</strong></td><td><strong>显示字符串</strong>，响应Ctrl_C<sup id="fnref-09h"><a href="#fn-09h" class="footnote-ref">09H</a></sup></td><td>DS:DX＝字符串首地址,字符串必须以‘$&#x27;(即ASCII码24H)为结束标志</td><td>无</td></tr><tr><td><strong>0AH</strong></td><td>等待键入一串字符送到用户程序数据缓冲区<sup id="fnref-0ah"><a href="#fn-0ah" class="footnote-ref">0AH</a></sup></td><td>DS:DX指向放键入字符的缓冲区。缓冲区定义形式规定为：</td><td>存放于缓冲区的字符串，以回车键结尾。</td></tr></tbody></table><p>![OAH图示](图片.assets/0AH PIC-1585709604726.png)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="bios功能调用"></a>BIOS功能调用<a class="hash-link" href="#bios功能调用" title="Direct link to heading">#</a></h2><p>主板EPROM中固化有基本I/O系统程序—BIOS,它是最接近硬件的驱动程序,BIOS中的许多子程序可被用户程序调用,调用这些子程序称为“BIOS功能调用”。</p><p><img alt="image-20200325112638363" src="/assets/images/image-20200325112638363-1585709604726-c908fba533b6f338ad9fa12c2f714747.png"></p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W assembly"><pre tabindex="0" class="prism-code language-assembly codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">MOv AH,[功能号]; 设置入口参数</span></span><span class="token-line" style="color:#393A34"><span class="token plain">INT n  ;分析出口参数</span></span><span class="token-line" style="color:#393A34"><span class="token plain">;其中INT n为软中断指令, n为中断类型码.不同n的代表不同的设备驱动程序</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="键盘输入功能调用（int-16h）"></a>键盘输入功能调用（INT 16H）<a class="hash-link" href="#键盘输入功能调用（int-16h）" title="Direct link to heading">#</a></h3><table><thead><tr><th>功能号</th><th>功能</th><th>入口参数</th><th>出口参数</th></tr></thead><tbody><tr><td>00H</td><td>读取键入的一个字符，无回显，响应Ctrl_C,无键入则等待</td><td>无</td><td>AL=键入字符的ASCII码。若AL=0，则AH=键入键的拓展码</td></tr><tr><td>01H</td><td>查询键盘缓冲区</td><td>无</td><td>Z标志＝0,表示有键入,键代码仍留在键盘缓冲区中,此时AL＝键入字符的ASCII码,AH＝键入字符的扩展码。<br> Z标志＝1,表示无键入。</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="bios屏显功能调用的调用模式（int-10h"></a>BIOS屏显功能调用的调用模式（int 10H)<a class="hash-link" href="#bios屏显功能调用的调用模式（int-10h" title="Direct link to heading">#</a></h3><p><img alt="image-20200411083907019" src="/assets/images/image-20200411083907019-8a95d3550f185cf31a2b1b0b4451bf0d.png"></p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W assembly"><pre tabindex="0" class="prism-code language-assembly codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">MOV AH,[功能号];预置入口参数</span></span><span class="token-line" style="color:#393A34"><span class="token plain">INT 10H;下面分析出口参数</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn">Copy</button></div></div><table><thead><tr><th>功能号</th><th>功能</th><th>入口参数</th><th>出口参数</th></tr></thead><tbody><tr><td>00H</td><td>设置屏幕显示方式<br>与21H 8号功能类似</td><td>AL=0 40x25 黑白文本方式<br>AL=1 40x25 彩色文本方式<br>AL=2 80x25 黑白文本方式<br>AL=3 80x25 彩色文本方式</td><td>无</td></tr><tr><td>01H</td><td>查询键盘缓冲区</td><td>无</td><td>Z标志为0，表示有键入，键入码仍留在键盘缓冲区中，此时AL=键入字符的ASCII码，AH=键入字符的拓展码<br>Z=1,表示无键入</td></tr><tr><td>02H</td><td>预置光标位置</td><td>BH=显示页号<br>DH=行号<br>DL=列号</td><td>无</td></tr><tr><td>03H</td><td>读取光标的当前位置</td><td>BH=显示页号</td><td>CH、CL＝光标顶部扫描线、低部扫描的行号<br>DH、DL=光标在屏幕上的行、列号</td></tr><tr><td>0EH</td><td><strong>显示一个字符</strong></td><td>AL=待显示的ASCII码<sup id="fnref-0eh"><a href="#fn-0eh" class="footnote-ref">0EH</a></sup></td><td>无</td></tr><tr><td>13H</td><td><strong>显示字符串</strong></td><td>AL=0~3<br>BH=显示页号，BL=属性字<sup id="fnref-bios13h"><a href="#fn-bios13h" class="footnote-ref">BIOS13H</a></sup><br>CX=串长度<br>DH、DL=字符串显示的起始行、列号<br>ES:BP=待显字符串首地址</td><td>无</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="程序设计方法"></a>程序设计方法<a class="hash-link" href="#程序设计方法" title="Direct link to heading">#</a></h2><ul><li>分析题意，确定算法</li><li>根据算法画出程序框图</li><li>根据框图编写程序</li><li>上机调试程序</li><li>执行程序</li></ul><p>从结构上讲，一般汇编程序可分为：</p><ul><li>顺序程序</li><li>分支程序<ul><li>简单分支</li><li>复合分支</li><li>多分支</li></ul></li><li>循环程序<ol><li>循环准备</li><li>循环体</li><li>循环控制</li></ol></li><li>子程序</li><li>宏指令</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="汇编程序结构语法"></a>汇编程序结构语法<a class="hash-link" href="#汇编程序结构语法" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="子程序设计"></a>子程序设计<a class="hash-link" href="#子程序设计" title="Direct link to heading">#</a></h3><p>参照第三章介绍相关置零时的内容<a href="/docs/notes-njupt/汇编语言指令集####%E5%AD%90%E7%A8%8B%E5%BA%8F%E8%B0%83%E7%94%A8%E5%8F%8A%E8%BF%94%E5%9B%9E%E6%8C%87%E4%BB%A4">子程序调用及返回指令</a>
子程序: 相对独立的程序，当程序中要多次完成某一操作时，为了简化整体程序，增强程序可读性，常常把“完成某一操作”的功能设计成一个子程序，供调用。</p><ol><li>子程序用PROC/ENDP定界</li><li>子程序分为：段内子程序、段间子程序、无参数子程序、有参数子程序</li><li>在子程序设计中<ul><li>要明确地定义出这个子程序的入口参数和出口参数，使调用者能方便地使 用子程序。</li><li>在子程序中在合理地保存主程序和子程序都用到的寄存器和存储单元，以使主程序能正确地运行。</li></ul></li></ol><p>参数传送主要有两种方式：</p><ol><li>利用寄存器传送参数</li><li>利用堆栈传送参数</li><li>利用某个内存单元 传送参数</li></ol><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W assembly"><pre tabindex="0" class="prism-code language-assembly codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">COMPUTE   PROC</span></span><span class="token-line" style="color:#393A34"><span class="token plain">MOV     AX，0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AGA:    ADD     AX，[BX]         ;求和</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ADD     BX，2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LOOP   AGA</span></span><span class="token-line" style="color:#393A34"><span class="token plain">RET                      ;返回断点XYZ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">COMPUTE   ENDP</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE      ENDS</span></span><span class="token-line" style="color:#393A34"><span class="token plain">END     BEG</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="宏指令程序设计"></a>宏指令程序设计<a class="hash-link" href="#宏指令程序设计" title="Direct link to heading">#</a></h3><p>“宏”是源程序中的一段有独立功能的程序代码。与子程序类似，可以简化程序设计，增强可读性，但是参数传递更加方便。
宏指令指用户自定义的指令。编程序时候，将多次使用的功能用一条宏指令来代替。经过定义的宏，通过写出宏名，即可调用。宏指令的定义一般放在程序的首部，不放在任何逻辑段中。</p><p><strong>无参数宏指令的定义语句格式：</strong></p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W assembly"><pre tabindex="0" class="prism-code language-assembly codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;宏指令名称&gt; MACRO &lt;哑元表:参数，可以省略&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;宏体&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENDM</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn">Copy</button></div></div><p>宏指令的定义与调用</p><ul><li>MACRO/ENDM是宏体的定界语句</li><li>宏体经过定义之后，宏指令的名称就是一条宏指令，可以像CPU指令那样去使用</li><li>在代码段中放置一条宏指令就是宏调用</li><li>编译时汇编程序用宏体替换宏指令</li></ul><p>有参宏指令的哑元表</p><ul><li>一串用逗号间隔的形式参数表</li><li>哑元是没有值的符号，用它(们)代表宏体中出现的操作码助记符、操作数(立即数、寄存器操作数、内存操作数)</li><li>调用时，宏指令行要有和哑元一一对应的实元表</li><li>实元可以是立即数、寄存器操作数以及没有PTR运算符的内存操作数</li></ul><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W assembly"><pre tabindex="0" class="prism-code language-assembly codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">CRLF    MACRO</span></span><span class="token-line" style="color:#393A34"><span class="token plain">MOV     AH,0EH</span></span><span class="token-line" style="color:#393A34"><span class="token plain">MOV     AL,0DH</span></span><span class="token-line" style="color:#393A34"><span class="token plain">INT       10H</span></span><span class="token-line" style="color:#393A34"><span class="token plain">MOV     AL,0AH</span></span><span class="token-line" style="color:#393A34"><span class="token plain">INT       10H</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENDM</span></span><span class="token-line" style="color:#393A34"><span class="token plain">;令光标返回到下一行的开始格,CRLF是宏指令的名称。宏体经过定义之后,宏指令的名称CRLF就是一条宏指令,在代码段中放置一条CRLF就是宏调用。</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">MOV     AH, 2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">MOV     DL, ’A’</span></span><span class="token-line" style="color:#393A34"><span class="token plain">INT       21H</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CRLF</span></span><span class="token-line" style="color:#393A34"><span class="token plain">;编译时汇编程序用宏体替换宏指令,因此执行CRLF后,光标返回下一行始格。</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn">Copy</button></div></div><p>LOCAL 指令<code>LOCAL 标号名表</code></p><ol><li>LOCAL伪指令要放在宏定义之中，是MACRO定界语句以下的第一条语句</li><li>标号名表是用逗号间隔的一串标号名，它们是宏体中出现的所有标号的集合</li><li>宏体中出现的标号称为局部标号，使用LOCAL伪指令后的局部标号允许和源程序中的其它标号、变量重名</li></ol><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W assembly"><pre tabindex="0" class="prism-code language-assembly codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">.486</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMPDISP  MACRO   NN</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LOCAL    LAST,NEXT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">MOV   DL,0     ;DL清0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">LAST:    CMP BEN,NN    ;比较</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         JC  NEXT      ;BEN ＜ NN 转</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         INC DL        ;DL加1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         SUB BEN,NN    ;BEN-NN→BEN</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         JMP LAST</span></span><span class="token-line" style="color:#393A34"><span class="token plain">NEXT:    ADD DL,30H</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         MOV AH,2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         INT 21H     ;显示</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENDM</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn">Copy</button></div></div><div class="footnotes"><hr><ol><li id="fn-简化">目前汇编语言源程序框架有完整段定义格式和简化段定义格式两种，<strong>MASM5.0</strong>版本开始支持了简化的段定义语句。为考虑兼容性，本书的<em>DOS</em>汇编程序都采用完整的汇编语言段定义格式。<a href="#fnref-%E7%AE%80%E5%8C%96" class="footnote-backref">↩</a></li><li id="fn-方式选择伪指令">通常,方式选择伪指令放在程序的头部,做为源程序的第一条语句。不设置方式选择伪指令与设置.8086是等价的。<a href="#fnref-%E6%96%B9%E5%BC%8F%E9%80%89%E6%8B%A9%E4%BC%AA%E6%8C%87%E4%BB%A4" class="footnote-backref">↩</a></li><li id="fn-0ah">缓冲区定义的第二个字节由系统设置，其余由用户定义；输入的字节数少于定义的字节数，缓冲区其余字节补零；输入的字节数大于定义的字节数，后来输入的字符丢弃且响铃警告。DOS功能调用<a href="#fnref-0ah" class="footnote-backref">↩</a></li><li id="fn-09h">9号功能破坏AL寄存器的内容。该项功能从屏幕当前位置开始,显示字符串,遇到结束标志‘$’时停止,‘$’字符并不显示<a href="#fnref-09h" class="footnote-backref">↩</a></li><li id="fn-02h">本功能在屏幕的当前位置显示一个字符,光标右移一格,如果是在一行末尾显示字符,则光标返回下一行的开始格。如果是在屏幕的右下角显示字符,光标返回时屏幕要上滚一行。<strong>注意</strong>：该功能要破坏AL寄存器的内容。<a href="#fnref-02h" class="footnote-backref">↩</a></li><li id="fn-01h">若AL＝0,表明按键是功能键,光标键,需再次调用本功能,才能返回按键的扩展码。<a href="#fnref-01h" class="footnote-backref">↩</a></li><li id="fn-bios13h">AL＝0、1时有效.13H功能是唯一能显示彩色字符的子功能字<a href="#fnref-bios13h" class="footnote-backref">↩</a></li><li id="fn-0eh">21H的02功能与INT 10H的0EH功能 一致，但是前者待显示字符放在DL中，后者放在AL中<a href="#fnref-0eh" class="footnote-backref">↩</a></li></ol></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/dosasm/dosasm/edit/docusaurus/docs/notes-njupt/04_汇编语言程序设计.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/notes-njupt/汇编语言指令集"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 3 汇编语言指令集</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/notes-njupt/输入输出系统"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">7 输入/输出系统 »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#汇编语言程序结构" class="table-of-contents__link">汇编语言程序结构</a><ul><li><a href="#汇编源程序的编程格式" class="table-of-contents__link">汇编源程序的编程格式</a></li></ul></li><li><a href="#dos调用" class="table-of-contents__link">DOS调用</a></li><li><a href="#bios功能调用" class="table-of-contents__link">BIOS功能调用</a><ul><li><a href="#键盘输入功能调用（int-16h）" class="table-of-contents__link">键盘输入功能调用（INT 16H）</a></li><li><a href="#bios屏显功能调用的调用模式（int-10h" class="table-of-contents__link">BIOS屏显功能调用的调用模式（int 10H)</a></li></ul></li><li><a href="#程序设计方法" class="table-of-contents__link">程序设计方法</a></li><li><a href="#汇编程序结构语法" class="table-of-contents__link">汇编程序结构语法</a><ul><li><a href="#子程序设计" class="table-of-contents__link">子程序设计</a></li><li><a href="#宏指令程序设计" class="table-of-contents__link">宏指令程序设计</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/references/README">References</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/dosasm" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://gitee.com/dosasm/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Docusaurus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://js-dos.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Js-Dos<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 DosAsm Project. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e84f90be.js"></script>
<script src="/assets/js/main.ffb5ba16.js"></script>
</body>
</html>